<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Django Rest API code generation with cog | Around the world in 80 days</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://openbermuda.github.io/80days/posts/django-rest-api-code-generation-with-cog.html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    },
    displayAlign: 'center', // Change this to 'center' to center equations.
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}}
    }
});
</script><!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Johnny Gill">
<meta property="og:site_name" content="Around the world in 80 days">
<meta property="og:title" content="Django Rest API code generation with cog">
<meta property="og:url" content="http://openbermuda.github.io/80days/posts/django-rest-api-code-generation-with-cog.html">
<meta property="og:description" content="After a good break for the holidays, a couple of weeks in the
frozen wastes of Canada complete with arriving home with a stinking
cold I am now at the, &quot;this code won't write itself&quot; part of the 80 da">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-01-14T21:12:36+00:00">
<meta property="article:tag" content="django">
<meta property="article:tag" content="python">
</head>
<body>
    <section class="social"><ul>
<li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://twitter.com/swfiua" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/swfiua" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Django Rest API code generation with cog</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2015-01-14T21:12:36+00:00">2015-01-14 21:12</time>
            
                      |  
        <a href="django-rest-api-code-generation-with-cog.rst" id="sourcelink">Source</a>

            </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../categories/django.html" rel="tag">django</a></li>
           <li><a class="tag p-category" href="../categories/python.html" rel="tag">python</a></li>
        </ul>
</div>

        </div>
        <div class="body">
            <div>
<p>After a good break for the holidays, a couple of weeks in the
frozen wastes of Canada complete with arriving home with a stinking
cold I am now at the, <em>"this code won't write itself"</em> part of the 80 days
project.</p>
<p>There is quite a bit to do, but I am still finding distractions to
spend time on.</p>
<p>I have been using <a class="reference external" href="http://www.django-rest-framework.org/">django rest framework</a> to create a REST api for
the project.</p>
<p>Creating serializers, api classes and url specs for these frameworks
is largely a matter of generating standard boiler plate code.  This is
the sort of stuff I hate doing: tedious and error prone.</p>
<p>I originally wrote my own noddy code generator to help with some of
this, but was less than satisfied with the result: it was fine for my
immediate needs, but as I add more models to the application I would
need to do more autogeneration.  I had the inescapable feeling that my
code generator was probably more trouble than it was worth.  At the
same time, writing code like this by hand is deeply unsatisfying.</p>
<p>So, just when it was looking like I would have to start learning
<a class="reference external" href="https://angularjs.org/">angular.js</a> and build the front end, Ned Batchelder came to the
rescue on Twitter by <a class="reference external" href="https://twitter.com/swfiua/status/554742651082539010">posting</a> a link to a new release of <a class="reference external" href="http://nedbatchelder.com/code/cog/">cog</a>.</p>
<p>Ned described it as "a small tool that does a small job well".</p>
<p>Sure enough, it does.  It lets you embed python code (disguised as
comments) within your code to do the code generation.</p>
<p>There are a few features in <em>cog</em> that appealed to me:</p>
<ul class="simple">
<li>the code generator can be run in a way that over-writes the input
file with the newly generated code</li>
<li>it calculates checksums for the generated code and embeds them in
the output.  This is useful as it allows it to spot if you have
edited the code since it was generated and hence refuse to
re-generate that code.</li>
<li>you can re-run and it will update the existing code, assuming the
checksums have not changed.</li>
</ul>
<p>Armed with cog, I came up with <a class="reference external" href="https://github.com/swfiua/django_eighty_days/blob/master/django_eighty_days/codegen.py">codegen.py</a> to generate the boring
bits of <a class="reference external" href="https://github.com/swfiua/django_eighty_days/blob/master/django_eighty_days/api.py">api.py</a> as well as <em>urls.py</em> and <em>serializers.py</em>.</p>
<p>I am quite happy with the results.  Doug Hellmann had suggested maybe
<a class="reference external" href="https://cookiecutter.readthedocs.org/en/latest/">cookiecutter</a> might be a better solution to this problem.  In my
case, I am using cookiecutter to get the base files for my django
application, but this code generation cannot take place until you add
some models, hence the need for cog.</p>
<p>Better still would be to combine the two and add codegen.py and
suitable urls.py, serializers.py and api.py to the cookiecutter
template.  I'll add that to the list of things to do, if only to delay
the learning of <a class="reference external" href="https://angularjs.org/">angular.js</a> ;)</p>
<!-- title: links -->
<!-- slug: references -->
<!-- date: 2014-11-13 14:08:31 UTC -->
<!-- tags: -->
<!-- link: -->
<!-- description: links to include in all posts -->
<!-- type: text -->
</div>
        </div>
                <ul class="pager">
<li class="previous">
                <a href="the-music-from-uncle.html" rel="prev" title="The Music from UNCLE">Previous post</a>
            </li>
            <li class="next">
                <a href="dancing-in-the-dark.html" rel="next" title="Dancing in the dark">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="eightydays",
            disqus_url="http://openbermuda.github.io/80days/posts/django-rest-api-code-generation-with-cog.html",
        disqus_title="Django Rest API code generation with cog",
        disqus_identifier="cache/posts/django-rest-api-code-generation-with-cog.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
                    <footer id="footer" role="contentinfo"><p>Contents © 2015         <a href="mailto:swfiua@gmail.com">Johnny Gill</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
            
        </footer>
</div>
    </section><script src="../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
